"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[304],{91196:(t,e,r)=>{r.d(e,{Z:()=>o});var n=r(23645),a=r.n(n)()((function(t){return t[1]}));a.push([t.id,"#verticalTable td[data-v-4b7afb54],#verticalTable th[data-v-4b7afb54]{vertical-align:middle}",""]);const o=a},92847:(t,e,r)=>{r.r(e),r.d(e,{default:()=>b});var n=r(87757),a=r.n(n);const o={name:"CustomSelect",props:{options:{required:!0},value:{default:""},name:{type:String,required:!0},placeholder:{type:String,default:function(){return this.$t("Select_One")}},form:{type:Object,required:!0}},computed:{selectId:function(){return"select_"+Math.random().toString(36).substring(7)}},mounted:function(){var t=this;$("#"+this.selectId).select2({data:this.options,placeholder:this.placeholder,width:"100%",allowClear:!0}).val(this.value).trigger("change").on("change",(function(){t.$emit("input",this.value)}))},watch:{value:function(t){$("#"+this.selectId).val(t).trigger("change"),this.$emit("change",t)},options:function(t){$("#"+this.selectId).empty().select2({placeholder:this.placeholder,width:"100%",allowClear:!0,data:t}).val("").trigger("change")}},destroyed:function(){this.$emit("input",""),$("#"+this.selectId).empty().off().select2("destroy")}};var i=r(51900);const s=(0,i.Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Fragment",[r("select",{staticClass:"form-control is-invalid",attrs:{name:t.name,id:t.selectId}},[r("option")]),t._v(" "),r("has-error",{attrs:{form:t.form,field:t.name}})],1)}),[],!1,null,"59940b7a",null).exports;const c={name:"CustomInput",props:{value:{default:null},type:{type:String,default:"text"},name:{type:String,required:!0},label:{type:String,required:!0},form:{type:Object,required:!0},required:{required:!1,type:Boolean,default:!1},readonly:{required:!1,type:Boolean,default:!1}},methods:{updateValue:function(t){this.$emit("input",t)}}};const l=(0,i.Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Fragment",[r("input",{staticClass:"form-control",class:{"is-invalid":t.form.errors.has(t.name)},attrs:{type:t.type,id:t.name,name:t.name,placeholder:t.label,required:t.required,readonly:t.readonly},domProps:{value:t.value},on:{input:function(e){return t.updateValue(e.target.value)}}}),t._v(" "),r("has-error",{attrs:{form:t.form,field:t.name}})],1)}),[],!1,null,"5201c141",null).exports;var d=r(9449);function u(t,e,r,n,a,o,i){try{var s=t[o](i),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,a)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){u(o,n,a,i,s,"next",t)}function s(t){u(o,n,a,i,s,"throw",t)}i(void 0)}))}}const f={name:"Create",components:{CustomSelect:s,CustomInput:l},data:function(){return{form:new Form({project_id:"",recommender_id:"",nid:"",ward_id:"",name:"",phone:""}),project:"",projects:[],benefits:[],wards:[],beneficiary:""}},methods:{loadActiveProject:function(){var t=this;return m(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/load-project-lists").then((function(e){t.projects=e.data}));case 2:case"end":return e.stop()}}),e)})))()},changeProject:function(t){var e=this;return m(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,axios.get("/api/load-project-details/".concat(t)).then((function(t){e.project=t.data}));case 2:case"end":return r.stop()}}),r)})))()},searchNID:function(){var t=this;return m(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.form.clear(),(r=new d(t.form,{project_id:"required",recommender_id:"required",nid:"required|numeric|digits_between:10,13"})).passes()?axios.post("/api/project-beneficiaries/search",{nid:t.form.nid}).then((function(e){var r;t.beneficiary=e.data,t.form.name=e.data.beneficiary.name,t.form.phone=e.data.beneficiary.phone,t.form.ward_id=null!==(r=e.data.beneficiary.ward_id)&&void 0!==r?r:t.form.ward_id})).catch((function(t){return console.log(t)})):t.form.errors.errors=r.errors.all();case 3:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;return m(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.form.clear(),!(r=new d(t.form,{project_id:"required",recommender_id:"required",ward_id:"required",nid:"required|numeric|digits_between:10,13"})).passes()){e.next=7;break}return e.next=5,t.form.post("/api/project-beneficiaries").then((function(e){"done"==e.data.type?(t.successCreateMessage(),t.decline()):Swal.fire({title:t.$t("confirmation"),text:t.$t("confirm_duplicate_message"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",reverseButtons:!0,confirmButtonText:t.$t("DuplicatePermit"),cancelButtonText:t.$t("cancel")}).then((function(e){e.isConfirmed&&t.form.post("/api/project-beneficiaries/duplicate").then((function(e){t.successCreateMessage(),t.decline()}))}))})).catch((function(t){return console.log(t)}));case 5:e.next=8;break;case 7:t.form.errors.errors=r.errors.all();case 8:case"end":return e.stop()}}),e)})))()},decline:function(){this.form.nid="",this.form.name="",this.form.phone="",this.benefits=[],this.beneficiary=""},loadWardList:function(){var t=this;axios.get("/api/load-ward-list").then((function(e){t.wards=e.data}))}},created:function(){this.loadActiveProject(),this.loadWardList()}};var p=r(93379),v=r.n(p),_=r(91196),h={insert:"head",singleton:!1};v()(_.Z,h);_.Z.locals;const b=(0,i.Z)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("custom-card",{attrs:{title:t.$t("NewProjectBeneficiary"),ticon:"fas fa-plus",url:"/project-beneficiaries",text:t.$t("ProjectBeneficiary")}},[r("table",{staticClass:"table table-bordered table-striped",attrs:{id:"verticalTable"}},[r("thead",[r("tr",[r("th",{staticClass:"text-right",attrs:{width:"20%"}},[t._v(t._s(t.$t("Title")))]),t._v(" "),r("th",[t._v(t._s(t.$t("Description")))])])]),t._v(" "),r("tbody",[r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("ProjectName")))]),t._v(" "),r("td",[r("custom-select",{attrs:{form:t.form,name:"project_id",options:t.projects},on:{change:t.changeProject},model:{value:t.form.project_id,callback:function(e){t.$set(t.form,"project_id",e)},expression:"form.project_id"}})],1)]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("ProjectDate")))]),t._v(" "),r("td",[t._v(t._s(t.project?t.project.date:""))])]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("ProjectInfo")))]),t._v(" "),r("td",[t._v(t._s(t._f("persons")(t.project?t.project.total:"")))])]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("Recommender")))]),t._v(" "),r("td",[r("custom-select",{attrs:{form:t.form,name:"recommender_id",options:t.project.recommenders},model:{value:t.form.recommender_id,callback:function(e){t.$set(t.form,"recommender_id",e)},expression:"form.recommender_id"}})],1)]),t._v(" "),r("tr",[r("td",{staticClass:"text-center font-weight-bold",attrs:{colspan:"2"}},[t._v(t._s(t.$t("BeneficiaryInformation")))])]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("NID")))]),t._v(" "),r("td",[r("small",{staticClass:"text-danger"},[t._v(t._s(t.$t("RightNIDWarning")))]),t._v(" "),r("div",{staticClass:"input-group"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.nid,expression:"form.nid"},{name:"mask",rawName:"v-mask",value:"#############",expression:"'#############'"}],staticClass:"form-control",attrs:{type:"number",placeholder:t.$t("NID")},domProps:{value:t.form.nid},on:{blur:t.searchNID,input:function(e){e.target.composing||t.$set(t.form,"nid",e.target.value)}}}),t._v(" "),r("div",{staticClass:"input-group-append"},[r("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.searchNID.apply(null,arguments)}}},[t._v(t._s(t.$t("Search")))])])]),t._v(" "),r("HasError",{attrs:{form:t.form,field:"nid"}})],1)]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("WardNumber")))]),t._v(" "),r("td",[r("custom-select",{attrs:{form:t.form,name:"ward_id",options:t.wards},model:{value:t.form.ward_id,callback:function(e){t.$set(t.form,"ward_id",e)},expression:"form.ward_id"}})],1)]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("Name")))]),t._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("BeneficiaryName")},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),t._v(" "),r("HasError",{attrs:{form:t.form,field:"name"}})],1)]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("Phone")))]),t._v(" "),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.phone,expression:"form.phone"},{name:"mask",rawName:"v-mask",value:"###########",expression:"'###########'"}],staticClass:"form-control",attrs:{type:"number",placeholder:t.$t("BeneficiaryPhone")},domProps:{value:t.form.phone},on:{input:function(e){e.target.composing||t.$set(t.form,"phone",e.target.value)}}}),t._v(" "),r("HasError",{attrs:{form:t.form,field:"phone"}})],1)]),t._v(" "),r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("PreviousBenefit")))]),t._v(" "),r("td",[r("table",{staticClass:"table table-bordered"},[r("thead",[r("tr",[r("th",[t._v(t._s(t.$t("SL")))]),t._v(" "),r("th",[t._v(t._s(t.$t("Date")))]),t._v(" "),r("th",[t._v(t._s(t.$t("Project")))]),t._v(" "),r("th",[t._v(t._s(t.$t("Recommender")))])])]),t._v(" "),t.beneficiary?r("tbody",[t.beneficiary.projects.length?t._l(t.beneficiary.projects,(function(e,n){return r("tr",{key:n},[r("td",[t._v(t._s(++n))]),t._v(" "),r("td",[t._v(t._s(e.date))]),t._v(" "),r("td",[t._v(t._s(e.name))]),t._v(" "),r("td",[t._v(t._s(e.recommender))])])})):r("tr",[r("td",{staticClass:"text-center",attrs:{colspan:"4"}},[t._v(t._s(t.$t("NoPreviousProjectFound")))])])],2):t._e()])])]),t._v(" "),t.beneficiary?r("tr",[r("td",{staticClass:"text-right font-weight-bold"},[t._v(t._s(t.$t("Action")))]),t._v(" "),r("td",[r("div",{staticClass:"row"},[r("button",{staticClass:"col-md-6 btn btn-success btn-lg",on:{click:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[t._v(t._s(t.$t("Approve")))]),t._v(" "),r("button",{staticClass:"col-md-6 btn btn-danger btn-lg",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.decline.apply(null,arguments)}}},[t._v(t._s(t.$t("Decline")))])])])]):t._e()])])])}),[],!1,null,"4b7afb54",null).exports}}]);